<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>H4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HW4_files/libs/clipboard/clipboard.min.js"></script>
<script src="HW4_files/libs/quarto-html/quarto.js"></script>
<script src="HW4_files/libs/quarto-html/popper.min.js"></script>
<script src="HW4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HW4_files/libs/quarto-html/anchor.min.js"></script>
<link href="HW4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HW4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HW4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HW4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HW4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">H4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<p>Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <a href="https://quarto.org" class="uri">https://quarto.org</a>.</p>
</section>
<section id="running-code" class="level2">
<h2 class="anchored" data-anchor-id="running-code">Running Code</h2>
<p>When you click the <strong>Render</strong> button a document will be generated that includes both content and the output of embedded code. You can embed code like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("countrycode")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("MASS")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can add options to executable code like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
</div>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">file.choose</span>()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(file_path)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>WVS <span class="ot">=</span> <span class="st">`</span><span class="at">WVS_Cross-National_Wave_7_v6_0</span><span class="st">`</span> <span class="sc">|&gt;</span> <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>WVS<span class="sc">$</span>happiness <span class="ot">=</span> <span class="fu">case_when</span>(WVS<span class="sc">$</span>Q46<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="dv">4</span><span class="sc">-</span>WVS<span class="sc">$</span>Q46,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span>) <span class="co"># ALL ELSE IS NA</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(WVS<span class="sc">$</span>happiness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    0     1     2     3 
 2104 11791 52581 30093 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(WVS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 97220   614</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(WVS,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 614
  version        doi   A_WAVE A_YEAR A_STUDY B_COUNTRY B_COUNTRY_ALPHA C_COW_NUM
  &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;  &lt;int&gt;   &lt;int&gt;     &lt;int&gt; &lt;chr&gt;               &lt;int&gt;
1 6-0-0 (2024-0… doi.…      7   2018       2        20 AND                   232
2 6-0-0 (2024-0… doi.…      7   2018       2        20 AND                   232
3 6-0-0 (2024-0… doi.…      7   2018       2        20 AND                   232
4 6-0-0 (2024-0… doi.…      7   2018       2        20 AND                   232
5 6-0-0 (2024-0… doi.…      7   2018       2        20 AND                   232
# ℹ 606 more variables: C_COW_ALPHA &lt;chr&gt;, D_INTERVIEW &lt;int&gt;, S007 &lt;int&gt;,
#   J_INTDATE &lt;int&gt;, FW_START &lt;int&gt;, FW_END &lt;int&gt;, K_TIME_START &lt;dbl&gt;,
#   K_TIME_END &lt;dbl&gt;, K_DURATION &lt;int&gt;, Q_MODE &lt;int&gt;, N_REGION_ISO &lt;int&gt;,
#   N_REGION_WVS &lt;int&gt;, N_REGION_NUTS2 &lt;int&gt;, N_REG_NUTS1 &lt;int&gt;, N_TOWN &lt;int&gt;,
#   G_TOWNSIZE &lt;int&gt;, G_TOWNSIZE2 &lt;int&gt;, H_SETTLEMENT &lt;int&gt;, H_URBRURAL &lt;int&gt;,
#   I_PSU &lt;int&gt;, O1_LONGITUDE &lt;dbl&gt;, O2_LATITUDE &lt;dbl&gt;,
#   L_INTERVIEWER_NUMBER &lt;int&gt;, S_INTLANGUAGE &lt;int&gt;, LNGE_ISO &lt;chr&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>WVS<span class="sc">$</span>country <span class="ot">=</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> WVS<span class="sc">$</span>B_COUNTRY_ALPHA, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">destination =</span> <span class="st">"country.name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some values were not matched unambiguously: NIR</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(WVS<span class="sc">$</span>country , <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
            Andorra           Argentina             Armenia           Australia 
               1004                1003                1223                1813 
         Bangladesh             Bolivia              Brazil              Canada 
               1200                2067                1762                4018 
              Chile               China            Colombia              Cyprus 
               1000                3036                1520                1000 
            Czechia             Ecuador               Egypt            Ethiopia 
               1200                1200                1200                1230 
            Germany              Greece           Guatemala Hong Kong SAR China 
               1528                1200                1229                2075 
              India           Indonesia                Iran                Iraq 
               1692                3200                1499                1200 
              Japan              Jordan          Kazakhstan               Kenya 
               1353                1203                1276                1266 
         Kyrgyzstan             Lebanon               Libya     Macao SAR China 
               1200                1200                1196                1023 
           Malaysia            Maldives              Mexico            Mongolia 
               1313                1039                1741                1638 
            Morocco     Myanmar (Burma)         Netherlands         New Zealand 
               1200                1200                2145                1057 
          Nicaragua             Nigeria            Pakistan                Peru 
               1200                1237                1995                1400 
        Philippines         Puerto Rico             Romania              Russia 
               1200                1127                1257                1810 
             Serbia           Singapore            Slovakia         South Korea 
               1046                2012                1200                1245 
             Taiwan          Tajikistan            Thailand             Tunisia 
               1223                1200                1500                1208 
             Turkey             Ukraine      United Kingdom       United States 
               2415                1289                2609                2596 
            Uruguay          Uzbekistan           Venezuela             Vietnam 
               1000                1250                1190                1200 
           Zimbabwe                &lt;NA&gt; 
               1215                 447 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>WVS <span class="ot">=</span> WVS <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(WVS<span class="sc">$</span>Q262 , <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -5 103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>WVS<span class="sc">$</span>age <span class="ot">=</span> <span class="fu">ifelse</span>(WVS<span class="sc">$</span>Q262<span class="sc">&gt;</span><span class="dv">15</span>, WVS<span class="sc">$</span>Q262, <span class="cn">NA</span>) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(WVS<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>WVS <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(country, age)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>WVS <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_happiness =</span> <span class="fu">mean</span>(happiness, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(country , mean_happiness) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>WVS <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_happiness =</span> <span class="fu">mean</span>(happiness, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_happiness) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the following command tells R what the order of the countries</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as a categorical variable is</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> country)) <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(country , mean_happiness) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'steelblue3'</span>)<span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>WVS<span class="sc">$</span>belief_in_god <span class="ot">=</span> <span class="fu">ifelse</span>(WVS<span class="sc">$</span>Q165<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">2</span><span class="sc">-</span>WVS<span class="sc">$</span>Q165, <span class="cn">NA</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>WVS_country <span class="ot">=</span> WVS <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cor_god_happ =</span> <span class="fu">cor</span>(belief_in_god, happiness, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cor_god_happ) <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> country))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>WVS_country <span class="sc">|&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cor_god_happ)) <span class="sc">|&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(country , cor_god_happ)) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">col=</span><span class="st">'darkred'</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Where belief in God is positively correlated with happiness'</span>) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'correlation between belief in God and happiness'</span>)<span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>WVS_working <span class="ot">&lt;-</span>WVS <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    country,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    belief_in_god,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    Q112,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    Q121,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    Q131,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    Q176,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    Q260,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    Q270,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    Q273,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    Q274,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    Q275,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    Q269,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    Q276,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    Q285,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    happiness,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    Q286</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>corruption<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q112<span class="sc">&gt;</span><span class="dv">0</span>,WVS_working<span class="sc">$</span>Q112,<span class="cn">NA</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>migration<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q121<span class="sc">&gt;</span><span class="dv">0</span>,WVS_working<span class="sc">$</span>Q121,<span class="cn">NA</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>security<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q131<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">5</span><span class="sc">-</span>WVS_working<span class="sc">$</span>Q131,<span class="cn">NA</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>moral<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q176<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">11</span><span class="sc">-</span>WVS_working<span class="sc">$</span>Q176,<span class="cn">NA</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>citizen <span class="ot">&lt;-</span> WVS_working<span class="sc">$</span>Q269 <span class="sc">&gt;</span> <span class="dv">0</span> </span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>citizen <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>citizen <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>citizen <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">3</span>, </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>citizen <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">2</span>,WVS_working<span class="sc">$</span>citizen)))</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>education<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q276<span class="sc">&gt;</span><span class="dv">0</span>,WVS_working<span class="sc">$</span>Q276,<span class="cn">NA</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>wage_earner<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q285<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">3</span><span class="sc">-</span>WVS_working<span class="sc">$</span>Q285,<span class="cn">NA</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>saving<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q286<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">5</span><span class="sc">-</span>WVS_working<span class="sc">$</span>Q286,<span class="cn">NA</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>WVS_working <span class="ot">&lt;-</span> WVS_working <span class="sc">%&gt;%</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    Q260 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"male"</span>,</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    Q260 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"female"</span>,</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    Q260 <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  </span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>WVS_working <span class="ot">&lt;-</span> WVS_working <span class="sc">%&gt;%</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Marital =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Married"</span>,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Living together as married"</span>,</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Divorced"</span>,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Separated"</span>,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Widowed"</span>,</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Single"</span>,</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    Q273 <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>child<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q274<span class="sc">&gt;</span><span class="dv">0</span>,WVS_working<span class="sc">$</span>Q274,<span class="cn">NA</span>)</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>edu<span class="ot">=</span><span class="fu">ifelse</span>(WVS_working<span class="sc">$</span>Q275<span class="sc">&gt;</span><span class="dv">0</span>,WVS_working<span class="sc">$</span>Q275,<span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(WVS_working)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model_ols<span class="ot">&lt;-</span><span class="fu">lm</span>(happiness<span class="sc">~</span>country<span class="sc">+</span>corruption<span class="sc">+</span>migration<span class="sc">+</span>security<span class="sc">+</span>moral<span class="sc">+</span>citizen<span class="sc">+</span>wage_earner<span class="sc">+</span>age<span class="sc">+</span>belief_in_god<span class="sc">+</span>saving<span class="sc">+</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu,<span class="at">data=</span>WVS_working)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = happiness ~ country + corruption + migration + security + 
    moral + citizen + wage_earner + age + belief_in_god + saving + 
    gender + Marital + child + edu, data = WVS_working)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.73458 -0.32583 -0.04988  0.51729  1.95643 

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        1.3263955  0.1256799  10.554  &lt; 2e-16 ***
countryArgentina                   0.1196325  0.0494453   2.419 0.015546 *  
countryArmenia                     0.3865506  0.0487970   7.922 2.40e-15 ***
countryAustralia                   0.2021221  0.1197381   1.688 0.091412 .  
countryBangladesh                 -0.0167253  0.0407251  -0.411 0.681304    
countryBolivia                     0.0079615  0.0382843   0.208 0.835263    
countryBrazil                      0.1980291  0.0411986   4.807 1.54e-06 ***
countryCanada                     -0.0054280  0.0345630  -0.157 0.875210    
countryChile                       0.0900808  0.0432869   2.081 0.037438 *  
countryChina                       0.0503126  0.1186605   0.424 0.671565    
countryColombia                    0.4138156  0.0413649  10.004  &lt; 2e-16 ***
countryCyprus                     -0.0410371  0.0473169  -0.867 0.385793    
countryCzechia                    -0.0829777  0.0416481  -1.992 0.046339 *  
countryEcuador                     0.4139031  0.0410434  10.085  &lt; 2e-16 ***
countryEthiopia                    0.0199093  0.0449520   0.443 0.657840    
countryGermany                     0.0852742  0.0393677   2.166 0.030309 *  
countryGreece                     -0.2118816  0.0406618  -5.211 1.89e-07 ***
countryHong Kong SAR China        -0.2228237  0.0379003  -5.879 4.15e-09 ***
countryIndia                       0.0320377  0.0408391   0.784 0.432759    
countryIndonesia                   0.1733803  0.0345955   5.012 5.42e-07 ***
countryIran                       -0.3521358  0.0392909  -8.962  &lt; 2e-16 ***
countryJapan                       0.1499396  0.0423614   3.540 0.000401 ***
countryJordan                     -0.1249590  0.0403690  -3.095 0.001967 ** 
countryKazakhstan                  0.0386115  0.0418905   0.922 0.356677    
countryKenya                       0.1906370  0.0425188   4.484 7.36e-06 ***
countryKyrgyzstan                  0.4760431  0.0403589  11.795  &lt; 2e-16 ***
countryLebanon                    -0.1565114  0.0402561  -3.888 0.000101 ***
countryLibya                       0.0533618  0.0429626   1.242 0.214225    
countryMacao SAR China            -0.1279419  0.0452382  -2.828 0.004684 ** 
countryMalaysia                   -0.0711815  0.0396205  -1.797 0.072409 .  
countryMaldives                    0.0605840  0.0439815   1.377 0.168369    
countryMexico                      0.4420563  0.0372234  11.876  &lt; 2e-16 ***
countryMongolia                   -0.2438665  0.0372618  -6.545 6.03e-11 ***
countryMorocco                    -0.2260151  0.0454805  -4.969 6.74e-07 ***
countryMyanmar (Burma)            -0.0180782  0.0395048  -0.458 0.647228    
countryNetherlands                 0.0520933  0.0398139   1.308 0.190738    
countryNew Zealand                 0.1231687  0.0443461   2.777 0.005481 ** 
countryNicaragua                   0.1945459  0.0417798   4.656 3.23e-06 ***
countryNigeria                    -0.1042672  0.0437506  -2.383 0.017166 *  
countryPakistan                    0.2016588  0.0411610   4.899 9.65e-07 ***
countryPeru                        0.1777232  0.0412765   4.306 1.67e-05 ***
countryPhilippines                 0.2606490  0.0387625   6.724 1.79e-11 ***
countryPuerto Rico                 0.2616950  0.0420874   6.218 5.09e-10 ***
countryRomania                    -0.1979024  0.0413412  -4.787 1.70e-06 ***
countryRussia                     -0.1099905  0.0414235  -2.655 0.007928 ** 
countrySerbia                     -0.1560930  0.0430666  -3.624 0.000290 ***
countrySingapore                  -0.0582017  0.0378072  -1.539 0.123706    
countrySlovakia                   -0.3488250  0.0416348  -8.378  &lt; 2e-16 ***
countrySouth Korea                -0.1820277  0.0381309  -4.774 1.81e-06 ***
countryTaiwan                     -0.0297938  0.0400167  -0.745 0.456558    
countryTajikistan                  0.2392746  0.0379340   6.308 2.86e-10 ***
countryThailand                    0.0819462  0.0384660   2.130 0.033148 *  
countryTunisia                    -0.3270057  0.0417576  -7.831 4.95e-15 ***
countryTurkey                     -0.0805657  0.0374433  -2.152 0.031429 *  
countryUkraine                    -0.0680351  0.0421049  -1.616 0.106135    
countryUnited States               0.0709918  0.0368854   1.925 0.054279 .  
countryUruguay                     0.3651909  0.0455294   8.021 1.08e-15 ***
countryUzbekistan                  0.2353349  0.0403755   5.829 5.63e-09 ***
countryVenezuela                  -0.0153677  0.0419735  -0.366 0.714271    
countryVietnam                     0.2527599  0.0388234   6.511 7.57e-11 ***
countryZimbabwe                   -0.6670309  0.0397840 -16.766  &lt; 2e-16 ***
corruption                        -0.0065003  0.0014331  -4.536 5.76e-06 ***
migration                          0.0177612  0.0032302   5.498 3.85e-08 ***
security                           0.1579390  0.0042242  37.389  &lt; 2e-16 ***
moral                             -0.0032918  0.0011507  -2.861 0.004229 ** 
citizen                            0.0204116  0.0378112   0.540 0.589318    
wage_earner                       -0.0244682  0.0077998  -3.137 0.001708 ** 
age                               -0.0018988  0.0002639  -7.194 6.38e-13 ***
belief_in_god                      0.0418991  0.0099454   4.213 2.53e-05 ***
saving                             0.0733667  0.0035904  20.434  &lt; 2e-16 ***
gendermale                        -0.0231323  0.0078596  -2.943 0.003250 ** 
MaritalLiving together as married  0.1639485  0.0324814   5.047 4.50e-07 ***
MaritalMarried                     0.1772209  0.0307424   5.765 8.24e-09 ***
MaritalSeparated                  -0.0897908  0.0481931  -1.863 0.062449 .  
MaritalSingle                      0.0700838  0.0672866   1.042 0.297617    
MaritalWidowed                     0.0019564  0.0365872   0.053 0.957355    
child                              0.0043023  0.0024835   1.732 0.083219 .  
edu                                0.0058113  0.0018996   3.059 0.002220 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6287 on 42454 degrees of freedom
Multiple R-squared:  0.1564,    Adjusted R-squared:  0.1549 
F-statistic: 102.2 on 77 and 42454 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(WVS_working)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>model_poly_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> country<span class="sc">+</span>corruption <span class="sc">+</span> migration <span class="sc">+</span> security <span class="sc">+</span> moral <span class="sc">+</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                     citizen<span class="sc">+</span> wage_earner <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                     belief_in_god <span class="sc">+</span> saving<span class="sc">++</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu, <span class="at">data =</span> WVS_working)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>model_poly_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> country<span class="sc">+</span>corruption <span class="sc">+</span> migration <span class="sc">+</span> security <span class="sc">+</span> moral <span class="sc">+</span> </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                     citizen<span class="sc">+</span> wage_earner <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                     belief_in_god <span class="sc">+</span> saving<span class="sc">++</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu, <span class="at">data =</span> WVS_working)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>model_poly_3 <span class="ot">&lt;-</span><span class="fu">lm</span>(happiness <span class="sc">~</span> country<span class="sc">+</span>corruption <span class="sc">+</span> migration <span class="sc">+</span> security <span class="sc">+</span> moral <span class="sc">+</span> </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                     citizen<span class="sc">+</span> wage_earner <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                     belief_in_god <span class="sc">+</span> saving<span class="sc">++</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu, <span class="at">data =</span> WVS_working)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_poly_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = happiness ~ country + corruption + migration + security + 
    moral + citizen + wage_earner + poly(age, 1) + belief_in_god + 
    saving + +gender + Marital + child + edu, data = WVS_working)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.73458 -0.32583 -0.04988  0.51729  1.95643 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        1.238662   0.124938   9.914  &lt; 2e-16 ***
countryArgentina                   0.119632   0.049445   2.419 0.015546 *  
countryArmenia                     0.386551   0.048797   7.922 2.40e-15 ***
countryAustralia                   0.202122   0.119738   1.688 0.091412 .  
countryBangladesh                 -0.016725   0.040725  -0.411 0.681304    
countryBolivia                     0.007962   0.038284   0.208 0.835263    
countryBrazil                      0.198029   0.041199   4.807 1.54e-06 ***
countryCanada                     -0.005428   0.034563  -0.157 0.875210    
countryChile                       0.090081   0.043287   2.081 0.037438 *  
countryChina                       0.050313   0.118660   0.424 0.671565    
countryColombia                    0.413816   0.041365  10.004  &lt; 2e-16 ***
countryCyprus                     -0.041037   0.047317  -0.867 0.385793    
countryCzechia                    -0.082978   0.041648  -1.992 0.046339 *  
countryEcuador                     0.413903   0.041043  10.085  &lt; 2e-16 ***
countryEthiopia                    0.019909   0.044952   0.443 0.657840    
countryGermany                     0.085274   0.039368   2.166 0.030309 *  
countryGreece                     -0.211882   0.040662  -5.211 1.89e-07 ***
countryHong Kong SAR China        -0.222824   0.037900  -5.879 4.15e-09 ***
countryIndia                       0.032038   0.040839   0.784 0.432759    
countryIndonesia                   0.173380   0.034596   5.012 5.42e-07 ***
countryIran                       -0.352136   0.039291  -8.962  &lt; 2e-16 ***
countryJapan                       0.149940   0.042361   3.540 0.000401 ***
countryJordan                     -0.124959   0.040369  -3.095 0.001967 ** 
countryKazakhstan                  0.038612   0.041891   0.922 0.356677    
countryKenya                       0.190637   0.042519   4.484 7.36e-06 ***
countryKyrgyzstan                  0.476043   0.040359  11.795  &lt; 2e-16 ***
countryLebanon                    -0.156511   0.040256  -3.888 0.000101 ***
countryLibya                       0.053362   0.042963   1.242 0.214225    
countryMacao SAR China            -0.127942   0.045238  -2.828 0.004684 ** 
countryMalaysia                   -0.071182   0.039620  -1.797 0.072409 .  
countryMaldives                    0.060584   0.043982   1.377 0.168369    
countryMexico                      0.442056   0.037223  11.876  &lt; 2e-16 ***
countryMongolia                   -0.243867   0.037262  -6.545 6.03e-11 ***
countryMorocco                    -0.226015   0.045481  -4.969 6.74e-07 ***
countryMyanmar (Burma)            -0.018078   0.039505  -0.458 0.647228    
countryNetherlands                 0.052093   0.039814   1.308 0.190738    
countryNew Zealand                 0.123169   0.044346   2.777 0.005481 ** 
countryNicaragua                   0.194546   0.041780   4.656 3.23e-06 ***
countryNigeria                    -0.104267   0.043751  -2.383 0.017166 *  
countryPakistan                    0.201659   0.041161   4.899 9.65e-07 ***
countryPeru                        0.177723   0.041276   4.306 1.67e-05 ***
countryPhilippines                 0.260649   0.038763   6.724 1.79e-11 ***
countryPuerto Rico                 0.261695   0.042087   6.218 5.09e-10 ***
countryRomania                    -0.197902   0.041341  -4.787 1.70e-06 ***
countryRussia                     -0.109991   0.041424  -2.655 0.007928 ** 
countrySerbia                     -0.156093   0.043067  -3.624 0.000290 ***
countrySingapore                  -0.058202   0.037807  -1.539 0.123706    
countrySlovakia                   -0.348825   0.041635  -8.378  &lt; 2e-16 ***
countrySouth Korea                -0.182028   0.038131  -4.774 1.81e-06 ***
countryTaiwan                     -0.029794   0.040017  -0.745 0.456558    
countryTajikistan                  0.239275   0.037934   6.308 2.86e-10 ***
countryThailand                    0.081946   0.038466   2.130 0.033148 *  
countryTunisia                    -0.327006   0.041758  -7.831 4.95e-15 ***
countryTurkey                     -0.080566   0.037443  -2.152 0.031429 *  
countryUkraine                    -0.068035   0.042105  -1.616 0.106135    
countryUnited States               0.070992   0.036885   1.925 0.054279 .  
countryUruguay                     0.365191   0.045529   8.021 1.08e-15 ***
countryUzbekistan                  0.235335   0.040376   5.829 5.63e-09 ***
countryVenezuela                  -0.015368   0.041973  -0.366 0.714271    
countryVietnam                     0.252760   0.038823   6.511 7.57e-11 ***
countryZimbabwe                   -0.667031   0.039784 -16.766  &lt; 2e-16 ***
corruption                        -0.006500   0.001433  -4.536 5.76e-06 ***
migration                          0.017761   0.003230   5.498 3.85e-08 ***
security                           0.157939   0.004224  37.389  &lt; 2e-16 ***
moral                             -0.003292   0.001151  -2.861 0.004229 ** 
citizen                            0.020412   0.037811   0.540 0.589318    
wage_earner                       -0.024468   0.007800  -3.137 0.001708 ** 
poly(age, 1)                      -5.526058   0.768118  -7.194 6.38e-13 ***
belief_in_god                      0.041899   0.009945   4.213 2.53e-05 ***
saving                             0.073367   0.003590  20.434  &lt; 2e-16 ***
gendermale                        -0.023132   0.007860  -2.943 0.003250 ** 
MaritalLiving together as married  0.163948   0.032481   5.047 4.50e-07 ***
MaritalMarried                     0.177221   0.030742   5.765 8.24e-09 ***
MaritalSeparated                  -0.089791   0.048193  -1.863 0.062449 .  
MaritalSingle                      0.070084   0.067287   1.042 0.297617    
MaritalWidowed                     0.001956   0.036587   0.053 0.957355    
child                              0.004302   0.002484   1.732 0.083219 .  
edu                                0.005811   0.001900   3.059 0.002220 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6287 on 42454 degrees of freedom
Multiple R-squared:  0.1564,    Adjusted R-squared:  0.1549 
F-statistic: 102.2 on 77 and 42454 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_poly_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = happiness ~ country + corruption + migration + security + 
    moral + citizen + wage_earner + poly(age, 2) + belief_in_god + 
    saving + +gender + Marital + child + edu, data = WVS_working)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7323 -0.3255 -0.0491  0.5151  1.9349 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        1.233264   0.124843   9.878  &lt; 2e-16 ***
countryArgentina                   0.113259   0.049413   2.292 0.021906 *  
countryArmenia                     0.385033   0.048760   7.897 2.94e-15 ***
countryAustralia                   0.194839   0.119649   1.628 0.103443    
countryBangladesh                 -0.029700   0.040725  -0.729 0.465831    
countryBolivia                    -0.005681   0.038291  -0.148 0.882061    
countryBrazil                      0.188875   0.041182   4.586 4.52e-06 ***
countryCanada                     -0.015987   0.034561  -0.463 0.643679    
countryChile                       0.086311   0.043256   1.995 0.046011 *  
countryChina                       0.056926   0.118572   0.480 0.631164    
countryColombia                    0.404606   0.041349   9.785  &lt; 2e-16 ***
countryCyprus                     -0.050526   0.047295  -1.068 0.285378    
countryCzechia                    -0.087287   0.041619  -2.097 0.035975 *  
countryEcuador                     0.403695   0.041031   9.839  &lt; 2e-16 ***
countryEthiopia                   -0.004027   0.045013  -0.089 0.928711    
countryGermany                     0.072342   0.039369   1.838 0.066142 .  
countryGreece                     -0.225610   0.040665  -5.548 2.91e-08 ***
countryHong Kong SAR China        -0.225192   0.037872  -5.946 2.77e-09 ***
countryIndia                       0.027769   0.040811   0.680 0.496229    
countryIndonesia                   0.167357   0.034577   4.840 1.30e-06 ***
countryIran                       -0.353174   0.039261  -8.996  &lt; 2e-16 ***
countryJapan                       0.127762   0.042416   3.012 0.002596 ** 
countryJordan                     -0.131350   0.040346  -3.256 0.001132 ** 
countryKazakhstan                  0.032888   0.041864   0.786 0.432107    
countryKenya                       0.171395   0.042552   4.028 5.64e-05 ***
countryKyrgyzstan                  0.466234   0.040346  11.556  &lt; 2e-16 ***
countryLebanon                    -0.161380   0.040230  -4.011 6.04e-05 ***
countryLibya                       0.050396   0.042931   1.174 0.240448    
countryMacao SAR China            -0.129595   0.045204  -2.867 0.004147 ** 
countryMalaysia                   -0.076467   0.039595  -1.931 0.053465 .  
countryMaldives                    0.053337   0.043957   1.213 0.224988    
countryMexico                      0.429995   0.037224  11.551  &lt; 2e-16 ***
countryMongolia                   -0.253036   0.037250  -6.793 1.11e-11 ***
countryMorocco                    -0.227627   0.045446  -5.009 5.50e-07 ***
countryMyanmar (Burma)            -0.024005   0.039481  -0.608 0.543184    
countryNetherlands                 0.041307   0.039805   1.038 0.299403    
countryNew Zealand                 0.106129   0.044361   2.392 0.016744 *  
countryNicaragua                   0.181269   0.041779   4.339 1.44e-05 ***
countryNigeria                    -0.122939   0.043777  -2.808 0.004982 ** 
countryPakistan                    0.186757   0.041170   4.536 5.74e-06 ***
countryPeru                        0.170235   0.041255   4.126 3.69e-05 ***
countryPhilippines                 0.252663   0.038745   6.521 7.05e-11 ***
countryPuerto Rico                 0.247091   0.042093   5.870 4.39e-09 ***
countryRomania                    -0.204146   0.041317  -4.941 7.80e-07 ***
countryRussia                     -0.116883   0.041400  -2.823 0.004756 ** 
countrySerbia                     -0.162392   0.043040  -3.773 0.000162 ***
countrySingapore                  -0.059279   0.037778  -1.569 0.116623    
countrySlovakia                   -0.356490   0.041613  -8.567  &lt; 2e-16 ***
countrySouth Korea                -0.180981   0.038102  -4.750 2.04e-06 ***
countryTaiwan                     -0.035579   0.039992  -0.890 0.373661    
countryTajikistan                  0.232081   0.037915   6.121 9.38e-10 ***
countryThailand                    0.082676   0.038437   2.151 0.031485 *  
countryTunisia                    -0.327170   0.041725  -7.841 4.57e-15 ***
countryTurkey                     -0.078894   0.037415  -2.109 0.034983 *  
countryUkraine                    -0.074926   0.042081  -1.781 0.074999 .  
countryUnited States               0.058284   0.036890   1.580 0.114126    
countryUruguay                     0.356478   0.045507   7.833 4.85e-15 ***
countryUzbekistan                  0.224013   0.040368   5.549 2.89e-08 ***
countryVenezuela                  -0.027156   0.041966  -0.647 0.517582    
countryVietnam                     0.248148   0.038798   6.396 1.61e-10 ***
countryZimbabwe                   -0.681278   0.039792 -17.121  &lt; 2e-16 ***
corruption                        -0.006302   0.001432  -4.400 1.08e-05 ***
migration                          0.017366   0.003228   5.380 7.50e-08 ***
security                           0.156943   0.004223  37.167  &lt; 2e-16 ***
moral                             -0.003328   0.001150  -2.894 0.003803 ** 
citizen                            0.022173   0.037783   0.587 0.557309    
wage_earner                       -0.018761   0.007825  -2.398 0.016511 *  
poly(age, 2)1                     -5.672234   0.767737  -7.388 1.51e-13 ***
poly(age, 2)2                      5.334583   0.654566   8.150 3.74e-16 ***
belief_in_god                      0.040943   0.009938   4.120 3.80e-05 ***
saving                             0.072804   0.003588  20.289  &lt; 2e-16 ***
gendermale                        -0.025599   0.007859  -3.257 0.001126 ** 
MaritalLiving together as married  0.158810   0.032463   4.892 1.00e-06 ***
MaritalMarried                     0.176027   0.030719   5.730 1.01e-08 ***
MaritalSeparated                  -0.089213   0.048156  -1.853 0.063949 .  
MaritalSingle                      0.055222   0.067260   0.821 0.411632    
MaritalWidowed                    -0.017983   0.036641  -0.491 0.623572    
child                              0.006602   0.002498   2.643 0.008214 ** 
edu                                0.006447   0.001900   3.394 0.000690 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6282 on 42453 degrees of freedom
Multiple R-squared:  0.1577,    Adjusted R-squared:  0.1562 
F-statistic: 101.9 on 78 and 42453 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_poly_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = happiness ~ country + corruption + migration + security + 
    moral + citizen + wage_earner + poly(age, 3) + belief_in_god + 
    saving + +gender + Marital + child + edu, data = WVS_working)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.73295 -0.32554 -0.04889  0.51516  1.93428 

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        1.233295   0.124845   9.879  &lt; 2e-16 ***
countryArgentina                   0.113182   0.049415   2.290 0.022001 *  
countryArmenia                     0.384969   0.048761   7.895 2.97e-15 ***
countryAustralia                   0.194627   0.119655   1.627 0.103835    
countryBangladesh                 -0.029844   0.040731  -0.733 0.463744    
countryBolivia                    -0.005874   0.038302  -0.153 0.878109    
countryBrazil                      0.188802   0.041184   4.584 4.57e-06 ***
countryCanada                     -0.016005   0.034561  -0.463 0.643304    
countryChile                       0.086279   0.043257   1.995 0.046095 *  
countryChina                       0.056716   0.118577   0.478 0.632433    
countryColombia                    0.404475   0.041353   9.781  &lt; 2e-16 ***
countryCyprus                     -0.050759   0.047308  -1.073 0.283292    
countryCzechia                    -0.087306   0.041620  -2.098 0.035938 *  
countryEcuador                     0.403543   0.041037   9.834  &lt; 2e-16 ***
countryEthiopia                   -0.004293   0.045031  -0.095 0.924049    
countryGermany                     0.072434   0.039372   1.840 0.065815 .  
countryGreece                     -0.225433   0.040674  -5.542 3.00e-08 ***
countryHong Kong SAR China        -0.225277   0.037875  -5.948 2.74e-09 ***
countryIndia                       0.027738   0.040812   0.680 0.496724    
countryIndonesia                   0.167336   0.034577   4.839 1.31e-06 ***
countryIran                       -0.353123   0.039262  -8.994  &lt; 2e-16 ***
countryJapan                       0.127943   0.042425   3.016 0.002565 ** 
countryJordan                     -0.131496   0.040352  -3.259 0.001120 ** 
countryKazakhstan                  0.032835   0.041865   0.784 0.432874    
countryKenya                       0.171216   0.042560   4.023 5.76e-05 ***
countryKyrgyzstan                  0.466111   0.040350  11.552  &lt; 2e-16 ***
countryLebanon                    -0.161378   0.040230  -4.011 6.05e-05 ***
countryLibya                       0.050277   0.042935   1.171 0.241607    
countryMacao SAR China            -0.129653   0.045205  -2.868 0.004131 ** 
countryMalaysia                   -0.076526   0.039597  -1.933 0.053287 .  
countryMaldives                    0.053419   0.043959   1.215 0.224291    
countryMexico                      0.429854   0.037230  11.546  &lt; 2e-16 ***
countryMongolia                   -0.253116   0.037252  -6.795 1.10e-11 ***
countryMorocco                    -0.227485   0.045451  -5.005 5.61e-07 ***
countryMyanmar (Burma)            -0.024090   0.039483  -0.610 0.541787    
countryNetherlands                 0.041247   0.039807   1.036 0.300120    
countryNew Zealand                 0.106180   0.044362   2.393 0.016694 *  
countryNicaragua                   0.181095   0.041788   4.334 1.47e-05 ***
countryNigeria                    -0.123088   0.043783  -2.811 0.004936 ** 
countryPakistan                    0.186710   0.041171   4.535 5.78e-06 ***
countryPeru                        0.170213   0.041256   4.126 3.70e-05 ***
countryPhilippines                 0.252526   0.038751   6.517 7.27e-11 ***
countryPuerto Rico                 0.247041   0.042094   5.869 4.42e-09 ***
countryRomania                    -0.204196   0.041318  -4.942 7.76e-07 ***
countryRussia                     -0.116946   0.041402  -2.825 0.004735 ** 
countrySerbia                     -0.162458   0.043042  -3.774 0.000161 ***
countrySingapore                  -0.059362   0.037781  -1.571 0.116138    
countrySlovakia                   -0.356597   0.041617  -8.569  &lt; 2e-16 ***
countrySouth Korea                -0.181114   0.038107  -4.753 2.01e-06 ***
countryTaiwan                     -0.035643   0.039994  -0.891 0.372816    
countryTajikistan                  0.231915   0.037923   6.115 9.72e-10 ***
countryThailand                    0.082596   0.038439   2.149 0.031657 *  
countryTunisia                    -0.327180   0.041726  -7.841 4.57e-15 ***
countryTurkey                     -0.078851   0.037416  -2.107 0.035087 *  
countryUkraine                    -0.074977   0.042082  -1.782 0.074807 .  
countryUnited States               0.058217   0.036892   1.578 0.114561    
countryUruguay                     0.356468   0.045507   7.833 4.87e-15 ***
countryUzbekistan                  0.223931   0.040371   5.547 2.93e-08 ***
countryVenezuela                  -0.027249   0.041969  -0.649 0.516167    
countryVietnam                     0.248173   0.038798   6.397 1.61e-10 ***
countryZimbabwe                   -0.681408   0.039797 -17.122  &lt; 2e-16 ***
corruption                        -0.006303   0.001432  -4.401 1.08e-05 ***
migration                          0.017372   0.003228   5.381 7.44e-08 ***
security                           0.156936   0.004223  37.164  &lt; 2e-16 ***
moral                             -0.003328   0.001150  -2.894 0.003807 ** 
citizen                            0.022110   0.037784   0.585 0.558443    
wage_earner                       -0.018702   0.007830  -2.389 0.016919 *  
poly(age, 3)1                     -5.679262   0.768430  -7.391 1.49e-13 ***
poly(age, 3)2                      5.336414   0.654628   8.152 3.68e-16 ***
poly(age, 3)3                     -0.138339   0.638214  -0.217 0.828397    
belief_in_god                      0.040945   0.009939   4.120 3.80e-05 ***
saving                             0.072786   0.003589  20.279  &lt; 2e-16 ***
gendermale                        -0.025582   0.007860  -3.255 0.001136 ** 
MaritalLiving together as married  0.158715   0.032466   4.889 1.02e-06 ***
MaritalMarried                     0.176016   0.030720   5.730 1.01e-08 ***
MaritalSeparated                  -0.089219   0.048157  -1.853 0.063934 .  
MaritalSingle                      0.054874   0.067280   0.816 0.414728    
MaritalWidowed                    -0.017804   0.036651  -0.486 0.627129    
child                              0.006637   0.002503   2.652 0.008010 ** 
edu                                0.006479   0.001905   3.400 0.000674 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6282 on 42452 degrees of freedom
Multiple R-squared:  0.1577,    Adjusted R-squared:  0.1562 
F-statistic: 100.6 on 79 and 42452 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The degree 2 gives me the best fit</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(WVS_working)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>WVS_working<span class="sc">$</span>happiness_factor<span class="ot">&lt;-</span><span class="fu">as.factor</span>(WVS_working<span class="sc">$</span>happiness)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(WVS_working<span class="sc">$</span>happiness_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0" "1" "2" "3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>order_model_poly_1 <span class="ot">&lt;-</span> <span class="fu">polr</span>(happiness_factor <span class="sc">~</span> country<span class="sc">+</span>corruption <span class="sc">+</span> migration <span class="sc">+</span> security <span class="sc">+</span> moral <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                     citizen<span class="sc">+</span> wage_earner <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                     belief_in_god <span class="sc">+</span> saving<span class="sc">++</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu, <span class="at">data =</span> WVS_working)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(order_model_poly_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Re-fitting to get Hessian</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = happiness_factor ~ country + corruption + migration + 
    security + moral + citizen + wage_earner + poly(age, 1) + 
    belief_in_god + saving + +gender + Marital + child + edu, 
    data = WVS_working)

Coefficients:
                                       Value Std. Error   t value
countryArgentina                    0.443974   0.154353   2.87635
countryArmenia                      1.377589   0.155156   8.87874
countryAustralia                    0.631846   0.375287   1.68363
countryBangladesh                  -0.040442   0.125176  -0.32308
countryBolivia                      0.144287   0.120917   1.19327
countryBrazil                       0.652761   0.127408   5.12340
countryCanada                       0.007691   0.105388   0.07298
countryChile                        0.354115   0.134513   2.63256
countryChina                        0.178377   0.372134   0.47934
countryColombia                     1.563321   0.132545  11.79468
countryCyprus                      -0.059915   0.147591  -0.40595
countryCzechia                     -0.244874   0.127686  -1.91779
countryEcuador                      1.591871   0.132005  12.05920
countryEthiopia                     0.153272   0.140578   1.09029
countryGermany                      0.317070   0.120872   2.62320
countryGreece                      -0.535072   0.126798  -4.21990
countryHong Kong SAR China         -0.647055   0.116435  -5.55724
countryIndia                        0.241231   0.127350   1.89423
countryIndonesia                    0.604529   0.105857   5.71080
countryIran                        -0.959851   0.123179  -7.79231
countryJapan                        0.498089   0.130420   3.81912
countryJordan                      -0.353281   0.124914  -2.82819
countryKazakhstan                   0.170084   0.129268   1.31574
countryKenya                        0.860738   0.135693   6.34326
countryKyrgyzstan                   1.780321   0.131757  13.51211
countryLebanon                     -0.478996   0.124346  -3.85213
countryLibya                        0.206159   0.132356   1.55761
countryMacao SAR China             -0.396055   0.137991  -2.87015
countryMalaysia                    -0.180659   0.121875  -1.48234
countryMaldives                     0.241217   0.136126   1.77202
countryMexico                       1.572586   0.116486  13.50023
countryMongolia                    -0.710209   0.116229  -6.11041
countryMorocco                     -0.685057   0.139532  -4.90968
countryMyanmar (Burma)              0.077347   0.122541   0.63119
countryNetherlands                  0.199491   0.121342   1.64403
countryNew Zealand                  0.416259   0.135931   3.06229
countryNicaragua                    0.825091   0.132003   6.25056
countryNigeria                      0.057696   0.143732   0.40141
countryPakistan                     0.819999   0.128564   6.37815
countryPeru                         0.645259   0.129596   4.97900
countryPhilippines                  0.938679   0.120451   7.79305
countryPuerto Rico                  0.978054   0.131919   7.41404
countryRomania                     -0.583725   0.127862  -4.56526
countryRussia                      -0.326177   0.127176  -2.56477
countrySerbia                      -0.444435   0.132943  -3.34304
countrySingapore                   -0.140631   0.115846  -1.21394
countrySlovakia                    -0.994702   0.127944  -7.77453
countrySouth Korea                 -0.544635   0.115559  -4.71305
countryTaiwan                      -0.084218   0.122666  -0.68656
countryTajikistan                   0.928267   0.118695   7.82059
countryThailand                     0.344357   0.119551   2.88042
countryTunisia                     -0.985235   0.129070  -7.63334
countryTurkey                      -0.193308   0.115567  -1.67270
countryUkraine                     -0.187311   0.129938  -1.44154
countryUnited States                0.271996   0.112996   2.40714
countryUruguay                      1.262680   0.143167   8.81960
countryUzbekistan                   0.831412   0.125314   6.63463
countryVenezuela                    0.118227   0.133513   0.88551
countryVietnam                      0.850811   0.119293   7.13214
countryZimbabwe                    -1.920715   0.124652 -15.40856
corruption                         -0.017860   0.004601  -3.88161
migration                           0.054686   0.010415   5.25081
security                            0.515331   0.013975  36.87599
moral                              -0.010087   0.003699  -2.72696
citizen                             0.050495   0.118823   0.42495
wage_earner                        -0.079227   0.024919  -3.17943
poly(age, 1)                      -18.115066   2.448664  -7.39794
belief_in_god                       0.140877   0.031124   4.52631
saving                              0.224390   0.011585  19.36908
gendermale                         -0.073963   0.025124  -2.94397
MaritalLiving together as married   0.492982   0.104016   4.73950
MaritalMarried                      0.524933   0.098335   5.33820
MaritalSeparated                   -0.226485   0.156193  -1.45003
MaritalSingle                       0.253887   0.219022   1.15918
MaritalWidowed                      0.005385   0.116828   0.04610
child                               0.017440   0.008004   2.17888
edu                                 0.015337   0.006054   2.53321

Intercepts:
    Value    Std. Error t value 
0|1  -1.3785   0.3943    -3.4958
1|2   0.8482   0.3930     2.1581
2|3   3.8885   0.3935     9.8813

Residual Deviance: 78010.31 
AIC: 78170.31 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>order_model_poly_2 <span class="ot">&lt;-</span> <span class="fu">polr</span>(happiness_factor <span class="sc">~</span> country<span class="sc">+</span>corruption <span class="sc">+</span> migration <span class="sc">+</span> security <span class="sc">+</span> moral <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                     citizen<span class="sc">+</span> wage_earner <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                     belief_in_god <span class="sc">+</span> saving<span class="sc">++</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu, <span class="at">data =</span> WVS_working)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(order_model_poly_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Re-fitting to get Hessian</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = happiness_factor ~ country + corruption + migration + 
    security + moral + citizen + wage_earner + poly(age, 3) + 
    belief_in_god + saving + +gender + Marital + child + edu, 
    data = WVS_working)

Coefficients:
                                       Value Std. Error   t value
countryArgentina                    0.423286   0.154463   2.74038
countryArmenia                      1.376224   0.155192   8.86786
countryAustralia                    0.612798   0.375452   1.63216
countryBangladesh                  -0.084977   0.125343  -0.67795
countryBolivia                      0.096905   0.121088   0.80029
countryBrazil                       0.623071   0.127520   4.88605
countryCanada                      -0.026430   0.105480  -0.25057
countryChile                        0.344955   0.134528   2.56418
countryChina                        0.204197   0.372318   0.54845
countryColombia                     1.530807   0.132712  11.53478
countryCyprus                      -0.090838   0.147656  -0.61520
countryCzechia                     -0.257598   0.127737  -2.01664
countryEcuador                      1.557840   0.132152  11.78822
countryEthiopia                     0.066570   0.141033   0.47202
countryGermany                      0.276008   0.120964   2.28174
countryGreece                      -0.579263   0.127018  -4.56048
countryHong Kong SAR China         -0.653567   0.116450  -5.61245
countryIndia                        0.228806   0.127396   1.79603
countryIndonesia                    0.585429   0.105915   5.52733
countryIran                        -0.961742   0.123223  -7.80489
countryJapan                        0.427442   0.130745   3.26927
countryJordan                      -0.373872   0.124991  -2.99119
countryKazakhstan                   0.151685   0.129348   1.17269
countryKenya                        0.793280   0.136006   5.83268
countryKyrgyzstan                   1.752109   0.131895  13.28414
countryLebanon                     -0.493925   0.124363  -3.97165
countryLibya                        0.197831   0.132409   1.49409
countryMacao SAR China             -0.398795   0.138011  -2.88959
countryMalaysia                    -0.198724   0.121934  -1.62977
countryMaldives                     0.217089   0.136204   1.59385
countryMexico                       1.534615   0.116650  13.15577
countryMongolia                    -0.742245   0.116324  -6.38086
countryMorocco                     -0.688536   0.139539  -4.93438
countryMyanmar (Burma)              0.059195   0.122618   0.48276
countryNetherlands                  0.163222   0.121449   1.34395
countryNew Zealand                  0.357894   0.136066   2.63030
countryNicaragua                    0.778732   0.132194   5.89083
countryNigeria                     -0.007064   0.143984  -0.04906
countryPakistan                     0.772034   0.128792   5.99442
countryPeru                         0.621485   0.129680   4.79243
countryPhilippines                  0.912244   0.120544   7.56770
countryPuerto Rico                  0.930723   0.132058   7.04784
countryRomania                     -0.602184   0.127968  -4.70574
countryRussia                      -0.348520   0.127214  -2.73963
countrySerbia                      -0.463914   0.133019  -3.48757
countrySingapore                   -0.143201   0.115860  -1.23599
countrySlovakia                    -1.020223   0.128061  -7.96671
countrySouth Korea                 -0.541409   0.115620  -4.68267
countryTaiwan                      -0.099974   0.122681  -0.81491
countryTajikistan                   0.905321   0.118786   7.62142
countryThailand                     0.348288   0.119576   2.91270
countryTunisia                     -0.984999   0.129062  -7.63197
countryTurkey                      -0.185127   0.115589  -1.60160
countryUkraine                     -0.208881   0.130017  -1.60657
countryUnited States                0.230753   0.113130   2.03971
countryUruguay                      1.236987   0.143276   8.63362
countryUzbekistan                   0.794619   0.125464   6.33342
countryVenezuela                    0.074693   0.133607   0.55905
countryVietnam                      0.836780   0.119350   7.01116
countryZimbabwe                    -1.968956   0.124770 -15.78071
corruption                         -0.017173   0.004605  -3.72934
migration                           0.053457   0.010421   5.12963
security                            0.512863   0.013985  36.67262
moral                              -0.010221   0.003701  -2.76164
citizen                             0.057241   0.118881   0.48149
wage_earner                        -0.059754   0.025035  -2.38685
poly(age, 3)1                     -18.987318   2.456028  -7.73090
poly(age, 3)2                      18.295205   2.096279   8.72747
poly(age, 3)3                      -1.290236   2.043891  -0.63126
belief_in_god                       0.137182   0.031134   4.40621
saving                              0.222819   0.011593  19.22042
gendermale                         -0.082066   0.025151  -3.26296
MaritalLiving together as married   0.476997   0.104104   4.58191
MaritalMarried                      0.521885   0.098400   5.30370
MaritalSeparated                   -0.223551   0.156288  -1.43037
MaritalSingle                       0.199575   0.219440   0.90948
MaritalWidowed                     -0.061001   0.117170  -0.52062
child                               0.025537   0.008083   3.15944
edu                                 0.017851   0.006081   2.93552

Intercepts:
    Value    Std. Error t value 
0|1  -1.3517   0.3945    -3.4263
1|2   0.8742   0.3932     2.2233
2|3   3.9181   0.3937     9.9516

Residual Deviance: 77933.52 
AIC: 78097.52 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>order_model_poly_3 <span class="ot">&lt;-</span><span class="fu">polr</span>(happiness_factor <span class="sc">~</span> country<span class="sc">+</span>corruption <span class="sc">+</span> migration <span class="sc">+</span> security <span class="sc">+</span> moral <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                     citizen<span class="sc">+</span> wage_earner <span class="sc">+</span> <span class="fu">poly</span>(age, <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                     belief_in_god <span class="sc">+</span> saving<span class="sc">++</span>gender<span class="sc">+</span>Marital<span class="sc">+</span>child<span class="sc">+</span>edu, <span class="at">data =</span> WVS_working)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(order_model_poly_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Re-fitting to get Hessian</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = happiness_factor ~ country + corruption + migration + 
    security + moral + citizen + wage_earner + poly(age, 3) + 
    belief_in_god + saving + +gender + Marital + child + edu, 
    data = WVS_working)

Coefficients:
                                       Value Std. Error   t value
countryArgentina                    0.423286   0.154463   2.74038
countryArmenia                      1.376224   0.155192   8.86786
countryAustralia                    0.612798   0.375452   1.63216
countryBangladesh                  -0.084977   0.125343  -0.67795
countryBolivia                      0.096905   0.121088   0.80029
countryBrazil                       0.623071   0.127520   4.88605
countryCanada                      -0.026430   0.105480  -0.25057
countryChile                        0.344955   0.134528   2.56418
countryChina                        0.204197   0.372318   0.54845
countryColombia                     1.530807   0.132712  11.53478
countryCyprus                      -0.090838   0.147656  -0.61520
countryCzechia                     -0.257598   0.127737  -2.01664
countryEcuador                      1.557840   0.132152  11.78822
countryEthiopia                     0.066570   0.141033   0.47202
countryGermany                      0.276008   0.120964   2.28174
countryGreece                      -0.579263   0.127018  -4.56048
countryHong Kong SAR China         -0.653567   0.116450  -5.61245
countryIndia                        0.228806   0.127396   1.79603
countryIndonesia                    0.585429   0.105915   5.52733
countryIran                        -0.961742   0.123223  -7.80489
countryJapan                        0.427442   0.130745   3.26927
countryJordan                      -0.373872   0.124991  -2.99119
countryKazakhstan                   0.151685   0.129348   1.17269
countryKenya                        0.793280   0.136006   5.83268
countryKyrgyzstan                   1.752109   0.131895  13.28414
countryLebanon                     -0.493925   0.124363  -3.97165
countryLibya                        0.197831   0.132409   1.49409
countryMacao SAR China             -0.398795   0.138011  -2.88959
countryMalaysia                    -0.198724   0.121934  -1.62977
countryMaldives                     0.217089   0.136204   1.59385
countryMexico                       1.534615   0.116650  13.15577
countryMongolia                    -0.742245   0.116324  -6.38086
countryMorocco                     -0.688536   0.139539  -4.93438
countryMyanmar (Burma)              0.059195   0.122618   0.48276
countryNetherlands                  0.163222   0.121449   1.34395
countryNew Zealand                  0.357894   0.136066   2.63030
countryNicaragua                    0.778732   0.132194   5.89083
countryNigeria                     -0.007064   0.143984  -0.04906
countryPakistan                     0.772034   0.128792   5.99442
countryPeru                         0.621485   0.129680   4.79243
countryPhilippines                  0.912244   0.120544   7.56770
countryPuerto Rico                  0.930723   0.132058   7.04784
countryRomania                     -0.602184   0.127968  -4.70574
countryRussia                      -0.348520   0.127214  -2.73963
countrySerbia                      -0.463914   0.133019  -3.48757
countrySingapore                   -0.143201   0.115860  -1.23599
countrySlovakia                    -1.020223   0.128061  -7.96671
countrySouth Korea                 -0.541409   0.115620  -4.68267
countryTaiwan                      -0.099974   0.122681  -0.81491
countryTajikistan                   0.905321   0.118786   7.62142
countryThailand                     0.348288   0.119576   2.91270
countryTunisia                     -0.984999   0.129062  -7.63197
countryTurkey                      -0.185127   0.115589  -1.60160
countryUkraine                     -0.208881   0.130017  -1.60657
countryUnited States                0.230753   0.113130   2.03971
countryUruguay                      1.236987   0.143276   8.63362
countryUzbekistan                   0.794619   0.125464   6.33342
countryVenezuela                    0.074693   0.133607   0.55905
countryVietnam                      0.836780   0.119350   7.01116
countryZimbabwe                    -1.968956   0.124770 -15.78071
corruption                         -0.017173   0.004605  -3.72934
migration                           0.053457   0.010421   5.12963
security                            0.512863   0.013985  36.67262
moral                              -0.010221   0.003701  -2.76164
citizen                             0.057241   0.118881   0.48149
wage_earner                        -0.059754   0.025035  -2.38685
poly(age, 3)1                     -18.987318   2.456028  -7.73090
poly(age, 3)2                      18.295205   2.096279   8.72747
poly(age, 3)3                      -1.290236   2.043891  -0.63126
belief_in_god                       0.137182   0.031134   4.40621
saving                              0.222819   0.011593  19.22042
gendermale                         -0.082066   0.025151  -3.26296
MaritalLiving together as married   0.476997   0.104104   4.58191
MaritalMarried                      0.521885   0.098400   5.30370
MaritalSeparated                   -0.223551   0.156288  -1.43037
MaritalSingle                       0.199575   0.219440   0.90948
MaritalWidowed                     -0.061001   0.117170  -0.52062
child                               0.025537   0.008083   3.15944
edu                                 0.017851   0.006081   2.93552

Intercepts:
    Value    Std. Error t value 
0|1  -1.3517   0.3945    -3.4263
1|2   0.8742   0.3932     2.2233
2|3   3.9181   0.3937     9.9516

Residual Deviance: 77933.52 
AIC: 78097.52 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">70</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Uzbekistan"</span>, <span class="st">"Zimbabwe"</span>, <span class="st">"Kyrgyzstan"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">rep</span>(ages, <span class="fu">length</span>(countries))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>country <span class="ot">&lt;-</span> <span class="fu">rep</span>(countries, <span class="at">each =</span> <span class="fu">length</span>(ages))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>corruption <span class="ot">&lt;-</span> <span class="dv">1</span>       </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>migration <span class="ot">&lt;-</span> <span class="dv">1</span>       </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>security <span class="ot">&lt;-</span> <span class="dv">1</span>         </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>moral <span class="ot">&lt;-</span> <span class="dv">2</span>           </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>citizen <span class="ot">&lt;-</span> <span class="dv">1</span>          </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>wage_earner <span class="ot">&lt;-</span> <span class="dv">1</span>      </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>belief_in_god <span class="ot">&lt;-</span> <span class="dv">1</span>    </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="dv">3</span>       </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">&lt;-</span> <span class="dv">2</span>        </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>gender<span class="ot">=</span><span class="st">"male"</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>Marital<span class="ot">=</span><span class="st">"Single"</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>child<span class="ot">=</span><span class="dv">6</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>edu<span class="ot">=</span><span class="dv">7</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> age,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> country,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">corruption =</span> corruption,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">migration =</span> migration,</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">security =</span> security,</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">moral =</span> moral,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">citizen =</span> citizen,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">wage_earner =</span> wage_earner,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">belief_in_god =</span> belief_in_god,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> education,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">saving =</span> saving,</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender=</span>gender,</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Marital=</span>Marital,</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">child=</span>child,</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">edu=</span>edu</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>fake_data<span class="sc">$</span>p1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_poly_1, <span class="at">newdata =</span> fake_data)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>fake_data<span class="sc">$</span>p2<span class="ot">&lt;-</span> <span class="fu">predict</span>(model_poly_2, <span class="at">newdata =</span> fake_data)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>fake_data<span class="sc">$</span>p3<span class="ot">&lt;-</span> <span class="fu">predict</span>(model_poly_3, <span class="at">newdata =</span> fake_data)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>fake_data<span class="sc">$</span>p_order<span class="ot">&lt;-</span><span class="fu">predict</span>(order_model_poly_1, <span class="at">newdata =</span> fake_data)</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>fake_data<span class="sc">$</span>p_order2<span class="ot">&lt;-</span><span class="fu">predict</span>(order_model_poly_2, <span class="at">newdata =</span> fake_data)</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>fake_data<span class="sc">$</span>p_order3<span class="ot">&lt;-</span><span class="fu">predict</span>(order_model_poly_3, <span class="at">newdata =</span> fake_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this part is the require plot for HW other plot is for fun </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> p_order, <span class="at">color =</span>country)) <span class="sc">+</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>country)<span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Mean of p1"</span>, <span class="at">title =</span> <span class="st">"Average Model by Age"</span>, <span class="at">color =</span> <span class="st">"Country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>p1_model <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, age) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_p1 =</span> <span class="fu">mean</span>(p1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'country'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>p1_model<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">factor</span>(p1_model<span class="sc">$</span>country)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>p1_model <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_p1, <span class="at">color =</span>country)) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span>  </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Mean of p1"</span>, <span class="at">title =</span> <span class="st">"Average Model by Age"</span>, <span class="at">color =</span> <span class="st">"Country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p2_model <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, age) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_p2 =</span> <span class="fu">mean</span>(p2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'country'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>p2_model<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">factor</span>(p2_model<span class="sc">$</span>country)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>p2_model <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_p2, <span class="at">color =</span>country)) <span class="sc">+</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span>  </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Mean of p1"</span>, <span class="at">title =</span> <span class="st">"Average Model by Age"</span>, <span class="at">color =</span> <span class="st">"Country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model with world bank data</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>WB_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Frank/Desktop/H4/P_Data_Extract_From_World_Development_Indicators/fbb54597-0836-45b0-b44a-e3522428acd5_Series - Metadata.csv"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>WB_working <span class="ot">&lt;-</span> WB_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Country.Name, Series.Name, Year)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>WB_working<span class="ot">&lt;-</span>WB_working<span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span>Series.Name, <span class="at">values_from =</span>Year)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>bonus<span class="ot">&lt;-</span>WVS_working<span class="sc">%&gt;%</span><span class="fu">inner_join</span>(WB_working,<span class="at">by=</span><span class="fu">join_by</span>(country<span class="sc">==</span>Country.Name))</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>bonus<span class="sc">$</span>GDP_per_capital<span class="ot">=</span><span class="fu">as.numeric</span>(bonus<span class="sc">$</span><span class="st">`</span><span class="at">GDP per capita (current US$)</span><span class="st">`</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>bonus<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(bonus)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;-</span> bonus <span class="sc">%&gt;%</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">happiness_avg =</span> <span class="fu">mean</span>(happiness, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">corruption_avg =</span> <span class="fu">mean</span>(corruption, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">migration_avg =</span> <span class="fu">mean</span>(migration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">GDP_per_capital =</span> <span class="fu">first</span>(GDP_per_capital) </span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>model_aggregated <span class="ot">&lt;-</span> <span class="fu">lm</span>(happiness_avg <span class="sc">~</span> corruption_avg <span class="sc">+</span> migration_avg <span class="sc">+</span> GDP_per_capital, <span class="at">data =</span> aggregated_data)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_aggregated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = happiness_avg ~ corruption_avg + migration_avg + 
    GDP_per_capital, data = aggregated_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.72511 -0.12577 -0.01307  0.16348  0.39451 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      1.862e+00  3.599e-01   5.175 5.13e-06 ***
corruption_avg  -7.791e-03  2.945e-02  -0.265   0.7926    
migration_avg    1.386e-01  7.215e-02   1.921   0.0611 .  
GDP_per_capital -3.429e-07  1.739e-06  -0.197   0.8446    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2125 on 45 degrees of freedom
Multiple R-squared:  0.09446,   Adjusted R-squared:  0.03409 
F-statistic: 1.565 on 3 and 45 DF,  p-value: 0.211</code></pre>
</div>
</div>
<p>From the model I do not find the close relationship between GDP per capital with happiness</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>